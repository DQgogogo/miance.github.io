<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>儿童九型人格性格测试表 (互动版 V2.2)</title>
    <style>
        html {
            scroll-behavior: smooth; /* Enables smooth scrolling for the whole page */
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
            background-color: #f7f9fc;
        }
        .container {
            background-color: #fff;
            padding: 25px 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 10px;
        }
        h2 {
            font-size: 1.1em;
            text-align: center;
            color: #7f8c8d;
            margin-top: 0;
        }
        h3 {
            background-color: #ecf0f1;
            padding: 10px 15px;
            border-radius: 6px;
            border-left: 5px solid #3498db;
            margin-top: 30px;
        }
        .warning {
            background-color: #fffbe6;
            border: 1px solid #ffe58f;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .warning-title {
            font-weight: bold;
            color: #d46b08;
        }
        .question {
            position: relative; /* Needed for the arrow positioning */
            margin-bottom: 12px;
            padding: 15px;
            padding-left: 35px; /* Make space for the arrow */
            border: 2px solid transparent;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.4s ease-in-out;
        }
        .focus-arrow {
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
            color: #3498db;
            opacity: 0;
            transition: opacity 0.4s;
        }
        .question.current-focus {
            background-color: #f8f9fa;
            border-color: #3498db;
        }
        .question.current-focus .focus-arrow {
            opacity: 1;
        }
        .question.answered {
            opacity: 0.6;
        }
        .question.current-focus.answered {
             opacity: 1; /* Keep current one fully visible */
        }
        .question.unanswered {
            background-color: #fff2f2 !important;
            border-color: #e74c3c !important;
            opacity: 1 !important;
        }
        .question-text {
            flex-grow: 1;
            padding-right: 15px;
        }
        .question-options {
            flex-shrink: 0;
            display: flex;
            gap: 10px;
        }
        .question-options label {
            cursor: pointer;
            padding: 5px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: all 0.2s;
        }
        .question-options input[type="radio"] {
            display: none;
        }
        .question-options input[type="radio"]:checked + span {
            font-weight: bold;
        }
        .question-options label.yes:has(input:checked) {
            background-color: #2ecc71;
            color: white;
            border-color: #27ae60;
        }
         .question-options label.no:has(input:checked) {
            background-color: #e74c3c;
            color: white;
            border-color: #c0392b;
        }
        .info-section {
            padding: 15px;
            border: 1px solid #ecf0f1;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        .info-field {
            margin-bottom: 15px;
        }
        .info-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .info-field input, .info-field select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .reminder-text {
            color: #e74c3c;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        button {
            display: block;
            width: 100%;
            padding: 15px;
            font-size: 1.25em;
            font-weight: bold;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 30px;
        }
        button:hover {
            background-color: #2980b9;
        }
        #results {
            margin-top: 30px;
            padding: 25px;
            background-color: #eaf5ff;
            border: 2px solid #b3d9ff;
            border-radius: 8px;
            display: none; /* Initially hidden */
        }
        #results h3 {
            background-color: transparent;
            border: none;
            padding-left: 0;
            margin-top: 0;
            text-align: center;
        }
        #results h3 small {
            display: block;
            font-size: 0.8em;
            color: #c0392b;
            font-weight: bold;
        }
        .result-summary, .result-details {
            margin-bottom: 15px;
        }
        .result-details ul, #basic-info-list {
            list-style-type: none;
            padding-left: 0;
        }
        .result-details li, #basic-info-list li {
            padding: 8px 12px;
            background-color: #fff;
            margin-bottom: 6px;
            border-radius: 4px;
        }
        .highlight {
            font-weight: bold;
            color: #2c3e50;
            background-color: #f1c40f !important;
        }
        .qr-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .qr-section img {
            max-width: 180px;
            height: auto;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>儿童九型人格性格测试表</h1>
        <h2>(互动计分版 V2.2 - 聚焦模式)</h2>

        <div class="warning">
            <p class="warning-title">⚠️ 测试前请仔细阅读</p>
            <ul>
                <li>这是一个辅助了解孩子性格倾向的参考工具，<strong>结果并非绝对</strong>。</li>
                <li>孩子的性格会在成长中不断丰富和变化，请<strong>不要用结果给孩子贴标签</strong>。</li>
                <li>本页面不储存任何信息，完成测试后，<strong>请务必将结果截图发给老师</strong>。</li>
            </ul>
        </div>

        <form id="enneagramQuiz">
            <div class="info-section">
                <div class="info-field">
                    <label for="childNickname">孩子昵称</label>
                    <input type="text" id="childNickname" placeholder="请输入孩子的常用昵称" required>
                </div>
                <p class="reminder-text">为确保分析的参考价值，请真实填写以下信息：</p>
                <div class="info-field">
                    <label for="birthDate">出生时间</label>
                    <input type="date" id="birthDate" required>
                </div>
                <div class="info-field">
                    <label for="gender">性别</label>
                    <select id="gender" required>
                        <option value="">请选择</option>
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>
                </div>
                <div class="info-field">
                    <label for="birthOrder">家中排行</label>
                    <select id="birthOrder" required>
                        <option value="">请选择</option>
                        <option value="独生子女">独生子女</option>
                        <option value="老大">老大</option>
                        <option value="中间">中间</option>
                        <option value="老幺">老幺</option>
                    </select>
                </div>
            </div>
            
            <div id="quiz-content"></div>

            <button type="submit">完成测试，查看结果</button>
        </form>

        <div id="results">
            <h3 id="result-header">探索结果<small>以下结果请截图发给老师</small></h3>
            <div id="basic-info-display"></div>
            <div class="result-summary" id="result-summary"></div>
            <div class="result-details">
                <h4>各项“是”的个数统计：</h4>
                <ul id="result-list"></ul>
            </div>
        </div>
        
        <div class="qr-section">
            <h4>咨询与深入解读</h4>
            <p>如需更深入的个性化解读和成长建议，<br>请扫描下方二维码联系老师进行咨询。</p>
            <img src="your-qr-code.png" alt="联系老师二维码">
        </div>

    </div>

    <script>
        const quizData = {
            A: { name: "领导力", questions: [ "身边朋友多。", "身强体壮，信心十足，精力旺盛。", "无论在哪里都喜欢发号令，认为自己理所当然是领头羊。", "经常轻视朋友或者与人发生争执。", "把好朋友或弟弟妹妹当做“自己人”，自己则扮演保护者的角色。", "发脾气时行为过激，甚至不可理喻，但是，脾气来得快去得也快，不会持续很长时间。", "不喜欢服从别人。", "勇敢有魄力，喜欢冒险。", "有时刚愎自用，顶撞父母或者老师。", "独立意识强，但也会尽心尽力孝顺父母。", "雷厉风行，敢作敢为。", "看到朋友说话做事慢条斯理，就会焦急烦躁，不能忍耐。", "做自己喜欢的事情时就劲头十足，埋头钻研。", "坦诚率真，但偶尔也有脆弱的一面。", "对前辈谦逊有礼，毕恭毕- 敬。" ] },
            B: { name: "调和力", questions: [ "温顺听话，让父母放心。", "不擅长整理，一些杂七杂八的东西不及时清理。", "喜欢父母拥抱自己或是类似的身体接触。", "购物时，挑选必用品需要很长时间。", "喜欢在家无所事事，或者用电视、电脑打发时间。", "一定要做的事情拖拖拉拉，开始之前浪费不少时间。", "考试时漫不经心，填写答案草草了事，知道的问题也经常出错。", "害怕电视或漫画中的暴力场景。", "家人或朋友吵架时，就会心情郁闷，有意回避。", "在学校里受了伤也不告诉父母，诸如此类的情况很多。", "平时不紧不慢，但一旦做起事来绝不中途放弃。", "如果受到训斥或者被强制做某事，就固执己见，什么都不想做。", "在他人面前言行不够自然大方。", "遇到选择性的问题，倾向于把决定权交给朋友或长辈。", "乐观开朗，游戏时不计较输赢，而更注重享受游戏本身。" ] },
            C: { name: "精进力", questions: [ "自己将房间或书桌整理得干净利落。", "眼疾手快，无须父母开口，自己就把事情做得井井有条。", "责任心强，无论担任何种角色，总是做得尽善尽美。", "认真，不喜欢玩笑。", "有毅力改正自己的缺点。", "在家里或学校经常包揽一些事情。", "喜欢忙碌紧张的生活节奏。", "放学回家后立即做作业，作业完成后才肯放松。", "在学校经常气愤地批评朋友不遵守纪律。", "喜欢装作了解、干涉他人。", "虽然不会欺负其他孩子，但总以一种颐指气使的姿态对他人指手画脚。", "在意别人对自己的看法，担心受到批评或指责。", "发脾气的时候经常过分紧张，不易恢复平静。", "生气时过分激动，时常自己憋气。", "富有正义感，思考问题比较理想化，渴望改善不良的现状。" ] },
            D: { name: "关系力", questions: [ "总是设身处地为他人着想而忽略自己。", "怜悯身处困境的人，希望自己可以帮助他们。", "心灵脆弱，有时会受到伤害。", "即使朋友不提任何要求，也总是把自己的玩具或点心与朋友一起分享。", "不擅长向他人提出要求。", "心理上排斥暴力性的镜头、悲剧性的故事或者残酷的新闻报道。", "有眼力见儿，别人不说，自己也能领会对方的意图。", "十分在意朋友喜欢的话题或是语气。", "为了博得对方的欢心或好感，经常表现得活泼开朗。", "喜欢朋友或弟弟妹妹依赖自己。", "比起学习或其他事情，把自己和朋友的关系放在第一位。", "和朋友吵架时，总是主动示好，希望恢复和对方的友谊。", "渴望得到父母的爱，并为此不断努力。", "如果父母喜欢或者疼爱其他孩子，就明显地表现出嫉妒。", "在意他人的反应或是对自己的评价。" ] },
            E: { name: "执行力", questions: [ "活泼开朗，好奇心强，才华横溢。", "踊跃参加学校活动，并发挥主导作用。", "责任心强，分内之事做得井井有条，善始善终。", "好胜心强，什么事都希望自己做到最好。", "学习刻苦，以期独享长辈的宠爱和夸奖。", "随机应变能力强，做事效率高，有条不紊。", "凡事喜欢一马当先。", "外出时在意着装，精心打扮。", "喜欢将自己最好的一面展示给别人，并为此大费心思，甚至不惜假装。", "追求时尚，想法现实。", "喜欢树立目标并为之奋斗。", "即使忙得不可交，也总是表现得朝气蓬勃，充满自信。", "对于“高兴”“悲伤”“寂寞”这样的情感表达无动于衷。", "如果自己有过失，就将错误转嫁到别人身上。", "认为只要能够达到目的，走走捷径或者说说谎话也无关紧要。" ] },
            F: { name: "想象力", questions: [ "对于故事、电影、音乐、美术等感性的东西非常有兴趣。", "挑选物品时十分挑剔，有收集美丽饰物的爱好。", "认生，常被环境氛围左右。", "心灵脆弱，情感细腻，有较强的感受性。", "不喜欢和朋友一样千人一面，暗自希望自己看上去与众不同。", "想象力丰富，喜欢创新。", "好静厌动，不喜欢有规律地做事。", "想要刻意表现得端庄稳重，温文雅尔。", "虽然性格较为内向，但在他人面前表现得充满活力。", "善于察言观色，待人体贴，乐于帮助别人。", "内心羡慕兄弟姐妹或朋友的优点。", "对批评非常敏感，偶尔因为一些琐碎的小事而伤心。", "如果认为父母误解了自己，就会拒绝一切表示反抗。", "不像个孩子，对死亡或悲剧性的事物感兴趣。", "喜欢读名人传记，或是理想化的人物和英雄的故事。" ] },
            G: { name: "学习力", questions: [ "喜欢自己玩。", "读书或是探究自己感兴趣的领域时，能够长时间地陶醉其中。", "朋友不多，喜欢与志趣相投的朋友安静地交谈。", "对理论感兴趣，喜欢搜集信息。", "遇到不理解的问题时，常常打破沙锅问到底或是查阅书籍，直到找到答案为止。", "话少安静，当别人询问自己的意见时，答案清晰明朗。", "比起烦冗的说明，更喜欢简洁有条理的对话。", "不喜欢别人动自己的物品。", "在聚会时，倾向于以听为主，像旁观者一样观察。", "表情单一，很多时候让人猜不透他在想什么。", "不喜欢受人关注。", "不喜欢集体活动。", "深沉内敛，即使是自己非常想得到的东西也不会缠着父母为自己买。", "对社会准则漠不关心。", "不随便丢弃东西，而是储存起来。" ] },
            H: { name: "觉察力", questions: [ "对父母百依百顺。", "典型的模范生，深得老师及朋友的信任。", "神经敏感，为一些琐事烦恼。", "做事小心翼翼，过分谨慎。", "喜欢和朋友成群结队。", "害怕自己被朋友疏远排斥。", "偶尔在背后抱怨或嘲讽朋友。", "富有同情心，怜悯弱者或有困难的人。", "遵守时间和秩序。", "优柔寡断，但一旦下定决心就坚持不懈。", "经常会有无谓的担心。", "胆小，易受惊吓。", "有时性情多变，本来有说有- 笑，却又会突然发起脾气。", "害怕受到斥责，做事小心谨慎以防出错。", "关心学校的事情，严格遵守学校的制度或指示。" ] },
            I: { name: "活动力", questions: [ "朋友成群，喜欢和朋友在一起。", "乐观向上，活泼开朗。", "对事漫不经心，常调皮或恶作剧。", "如果得不到喜欢的东西，就无法忍受。", "一拿到零用钱就花光。", "有意在言行上看起来比同龄人早熟。", "有明星意识和自我陶醉的倾向。", "好奇心强，一日多餐。", "喜欢开玩笑，让朋友心情愉快。", "经常向长辈撒娇。", "好动，很难在某个地方安静地坐一会儿，忍受不了无聊的事情。", "对什么事都十分自信，做事速度快。", "即使受到训斥，不一会儿就抛到九霄云外。", "对新事物很快就感到腻烦。", "做事虎头蛇- 尾，缺乏耐心和毅力。" ] }
        };

        const resultMapping = {
            A: "有主见的“领导型”孩子 (第8型)", B: "温和的“和平型”孩子 (第9型)",
            C: "追求卓越的“完美型”孩子 (第1型)", D: "热心肠的“助人型”孩子 (第2型)",
            E: "欲望强烈的“成就型”孩子 (第3型)", F: "个性鲜明的“浪漫型”孩子 (第4型)",
            G: "观察力强的“思考型”孩子 (第5型)", H: "慎重又忠诚的“忠诚型”孩子 (第6型)",
            I: "活泼开朗喜欢刺激的“活跃型”孩子 (第7型)"
        };
        
        const quizContent = document.getElementById('quiz-content');
        let allQuestionDivs = [];
        let currentFocusIndex = 0;

        // Generate Quiz HTML
        for (const key in quizData) {
            let sectionHTML = `<h3>TEST ${key} (${quizData[key].name})</h3>`;
            quizData[key].questions.forEach((q, index) => {
                const qId = `${key}${index + 1}`;
                sectionHTML += `
                    <div class="question" data-question-id="${qId}">
                        <div class="focus-arrow">▶</div>
                        <span class="question-text">${index + 1}. ${q}</span>
                        <div class="question-options">
                            <label class="yes"><input type="radio" name="q${qId}" value="yes" required><span>是</span></label>
                            <label class="no"><input type="radio" name="q${qId}" value="no"><span>否</span></label>
                        </div>
                    </div>
                `;
            });
            quizContent.innerHTML += sectionHTML;
        }

        allQuestionDivs = document.querySelectorAll('.question');

        function updateFocus(newIndex) {
            if (currentFocusIndex < allQuestionDivs.length) {
                allQuestionDivs[currentFocusIndex].classList.remove('current-focus');
            }
            if (newIndex < allQuestionDivs.length) {
                currentFocusIndex = newIndex;
                const newFocusQuestion = allQuestionDivs[currentFocusIndex];
                newFocusQuestion.classList.add('current-focus');
                // Scroll the element into the vertical center of the viewport
                newFocusQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Initialize focus on the first question
        if(allQuestionDivs.length > 0) {
            updateFocus(0);
        }

        // Add event listener to auto-advance and manage classes
        quizContent.addEventListener('change', function(event) {
            if (event.target.type === 'radio') {
                const parentQuestion = event.target.closest('.question');
                if (parentQuestion) {
                    parentQuestion.classList.add('answered');
                    if (parentQuestion.classList.contains('unanswered')) {
                        parentQuestion.classList.remove('unanswered');
                    }
                    
                    // Find current index and advance
                    const answeredIndex = Array.from(allQuestionDivs).indexOf(parentQuestion);
                    if (answeredIndex !== -1 && answeredIndex === currentFocusIndex) {
                         setTimeout(() => {
                           updateFocus(currentFocusIndex + 1);
                        }, 300); // A small delay for a better UX
                    }
                }
            }
        });

        // Handle Form Submission
        document.getElementById('enneagramQuiz').addEventListener('submit', function(event) {
            event.preventDefault();
            
            document.querySelectorAll('.question.unanswered').forEach(el => el.classList.remove('unanswered'));

            const childNickname = document.getElementById('childNickname').value;
            const birthDate = document.getElementById('birthDate').value;
            const gender = document.getElementById('gender').value;
            const birthOrder = document.getElementById('birthOrder').value;

            if (!childNickname || !birthDate || !gender || !birthOrder) {
                alert('请先填写完整的孩子基本信息。');
                document.querySelector('.info-section').scrollIntoView({ block: 'center' });
                return;
            }

            const unansweredQuestions = [];
            allQuestionDivs.forEach(qDiv => {
                const radioName = `q${qDiv.dataset.questionId}`;
                const isAnswered = document.querySelector(`input[name="${radioName}"]:checked`);
                if (!isAnswered) {
                    unansweredQuestions.push(qDiv);
                }
            });

            if (unansweredQuestions.length > 0) {
                alert(`您还有 ${unansweredQuestions.length} 道题目未完成，未作答的题目已用红色高亮标出。`);
                unansweredQuestions.forEach(qDiv => qDiv.classList.add('unanswered'));
                
                // Update focus to the first unanswered question
                const firstUnansweredIndex = Array.from(allQuestionDivs).indexOf(unansweredQuestions[0]);
                updateFocus(firstUnansweredIndex);
                return;
            }

            const counts = {};
            let maxCount = -1;
            let primaryTypes = [];

            for (const key in quizData) {
                let yesCount = 0;
                quizData[key].questions.forEach((q, index) => {
                    const qId = `${key}${index + 1}`;
                    const answer = document.querySelector(`input[name="q${qId}"]:checked`).value;
                    if (answer === 'yes') {
                        yesCount++;
                    }
                });
                counts[key] = yesCount;
            }

            for (const key in counts) {
                if (counts[key] > maxCount) {
                    maxCount = counts[key];
                    primaryTypes = [key];
                } else if (counts[key] === maxCount) {
                    primaryTypes.push(key);
                }
            }

            const resultsDiv = document.getElementById('results');
            const basicInfoDiv = document.getElementById('basic-info-display');
            const summaryDiv = document.getElementById('result-summary');
            const listUl = document.getElementById('result-list');

            basicInfoDiv.innerHTML = `
                <h4>基本信息</h4>
                <ul id="basic-info-list">
                    <li><strong>孩子昵称:</strong> ${childNickname}</li>
                    <li><strong>出生时间:</strong> ${birthDate}</li>
                    <li><strong>性别:</strong> ${gender}</li>
                    <li><strong>家中排行:</strong> ${birthOrder}</li>
                </ul>`;

            summaryDiv.innerHTML = `<h4>性格倾向初步探索</h4>
                                  <p><strong>主要性格倾向为：${primaryTypes.map(key => resultMapping[key]).join(' 和 ')}</strong></p>`;
            
            listUl.innerHTML = '';
            for (const key in counts) {
                const li = document.createElement('li');
                li.innerHTML = `<strong>测试 ${key} (${quizData[key].name}):</strong> ${counts[key]} 个“是”`;
                if (primaryTypes.includes(key)) {
                    li.classList.add('highlight');
                }
                listUl.appendChild(li);
            }

            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ block: 'center' });
        });
    </script>

</body>
</html>